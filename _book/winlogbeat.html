<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Winlogbeat | Elasticsearch Data Fundamentals</title>
  <meta name="description" content="4 Winlogbeat | Elasticsearch Data Fundamentals" />
  <meta name="generator" content="bookdown 0.21.7 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Winlogbeat | Elasticsearch Data Fundamentals" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Winlogbeat | Elasticsearch Data Fundamentals" />
  
  
  

<meta name="author" content="Arie Twigt" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="metricbeat.html"/>
<link rel="next" href="filebeat.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i><b>1</b> Setup</a><ul>
<li class="chapter" data-level="1.1" data-path="setup.html"><a href="setup.html#download-elasticsearch"><i class="fa fa-check"></i><b>1.1</b> Download Elasticsearch</a><ul>
<li class="chapter" data-level="1.1.1" data-path="setup.html"><a href="setup.html#download-and-unzip-the-elasticsearch-installation-in-your-home-directory"><i class="fa fa-check"></i><b>1.1.1</b> Download and unzip the Elasticsearch installation in your Home Directory</a></li>
<li class="chapter" data-level="1.1.2" data-path="setup.html"><a href="setup.html#start-elasticsearch-from-the-command-line"><i class="fa fa-check"></i><b>1.1.2</b> Start Elasticsearch from the Command Line</a></li>
<li class="chapter" data-level="1.1.3" data-path="setup.html"><a href="setup.html#changing-basic-settings-in-the-elasticsearch-configuration"><i class="fa fa-check"></i><b>1.1.3</b> Changing basic settings in the Elasticsearch configuration</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="setup.html"><a href="setup.html#getting-started-with-kibana"><i class="fa fa-check"></i><b>1.2</b> Getting started with Kibana</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="elasticsearch-and-kibana.html"><a href="elasticsearch-and-kibana.html"><i class="fa fa-check"></i><b>2</b> Elasticsearch and Kibana</a><ul>
<li class="chapter" data-level="2.1" data-path="elasticsearch-and-kibana.html"><a href="elasticsearch-and-kibana.html#start-elasticsearch"><i class="fa fa-check"></i><b>2.1</b> Start Elasticsearch</a></li>
<li class="chapter" data-level="2.2" data-path="elasticsearch-and-kibana.html"><a href="elasticsearch-and-kibana.html#start-kibana"><i class="fa fa-check"></i><b>2.2</b> Start Kibana</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="metricbeat.html"><a href="metricbeat.html"><i class="fa fa-check"></i><b>3</b> Metricbeat</a><ul>
<li class="chapter" data-level="3.1" data-path="metricbeat.html"><a href="metricbeat.html#setup-metricbeat-for-the-first-time"><i class="fa fa-check"></i><b>3.1</b> Setup Metricbeat for the first time</a></li>
<li class="chapter" data-level="3.2" data-path="metricbeat.html"><a href="metricbeat.html#check-out-the-metrics-dashboard"><i class="fa fa-check"></i><b>3.2</b> Check out the Metrics Dashboard</a></li>
<li class="chapter" data-level="3.3" data-path="metricbeat.html"><a href="metricbeat.html#enable-the-metrics-dashboard-in-kibana"><i class="fa fa-check"></i><b>3.3</b> Enable the Metrics Dashboard in Kibana</a></li>
<li class="chapter" data-level="3.4" data-path="metricbeat.html"><a href="metricbeat.html#specify-index-patterns"><i class="fa fa-check"></i><b>3.4</b> Specify Index Patterns</a></li>
<li class="chapter" data-level="3.5" data-path="metricbeat.html"><a href="metricbeat.html#checkout-our-metrics"><i class="fa fa-check"></i><b>3.5</b> Checkout our Metrics</a></li>
<li class="chapter" data-level="3.6" data-path="metricbeat.html"><a href="metricbeat.html#check-out-our-metrics-in-the-dashboard"><i class="fa fa-check"></i><b>3.6</b> Check out our Metrics in the Dashboard</a></li>
<li class="chapter" data-level="3.7" data-path="metricbeat.html"><a href="metricbeat.html#metrics-in-dashboard"><i class="fa fa-check"></i><b>3.7</b> Metrics in Dashboard</a></li>
<li class="chapter" data-level="3.8" data-path="metricbeat.html"><a href="metricbeat.html#metrics-in-discovery"><i class="fa fa-check"></i><b>3.8</b> Metrics in Discovery</a></li>
<li class="chapter" data-level="3.9" data-path="metricbeat.html"><a href="metricbeat.html#conclusion"><i class="fa fa-check"></i><b>3.9</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="winlogbeat.html"><a href="winlogbeat.html"><i class="fa fa-check"></i><b>4</b> Winlogbeat</a><ul>
<li class="chapter" data-level="4.1" data-path="winlogbeat.html"><a href="winlogbeat.html#setup-winlogbeat"><i class="fa fa-check"></i><b>4.1</b> Setup Winlogbeat</a></li>
<li class="chapter" data-level="4.2" data-path="winlogbeat.html"><a href="winlogbeat.html#initiate-the-windows-logs-dashboard-in-kibana"><i class="fa fa-check"></i><b>4.2</b> Initiate the Windows logs dashboard in Kibana</a></li>
<li class="chapter" data-level="4.3" data-path="winlogbeat.html"><a href="winlogbeat.html#check-out-the-windows-logs-in-the-elasticsearch-index"><i class="fa fa-check"></i><b>4.3</b> Check out the Windows logs in the Elasticsearch index</a></li>
<li class="chapter" data-level="4.4" data-path="winlogbeat.html"><a href="winlogbeat.html#index-patterns-en-discover"><i class="fa fa-check"></i><b>4.4</b> Index Patterns en Discover</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="filebeat.html"><a href="filebeat.html"><i class="fa fa-check"></i><b>5</b> Filebeat</a><ul>
<li class="chapter" data-level="5.1" data-path="filebeat.html"><a href="filebeat.html#configure-filebeat.yml"><i class="fa fa-check"></i><b>5.1</b> Configure <code>filebeat.yml</code></a></li>
<li class="chapter" data-level="5.2" data-path="filebeat.html"><a href="filebeat.html#run-filebeat"><i class="fa fa-check"></i><b>5.2</b> Run filebeat</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="logstash.html"><a href="logstash.html"><i class="fa fa-check"></i><b>6</b> Logstash</a><ul>
<li class="chapter" data-level="6.1" data-path="logstash.html"><a href="logstash.html#ingest-pipelines"><i class="fa fa-check"></i><b>6.1</b> Ingest Pipelines</a></li>
<li class="chapter" data-level="6.2" data-path="logstash.html"><a href="logstash.html#grok-patterns"><i class="fa fa-check"></i><b>6.2</b> Grok Patterns</a></li>
<li class="chapter" data-level="6.3" data-path="logstash.html"><a href="logstash.html#start-logstash"><i class="fa fa-check"></i><b>6.3</b> Start Logstash</a></li>
<li class="chapter" data-level="6.4" data-path="logstash.html"><a href="logstash.html#specify-filebeat-to-ingest-to-logstash"><i class="fa fa-check"></i><b>6.4</b> Specify Filebeat to ingest to Logstash</a></li>
<li class="chapter" data-level="6.5" data-path="logstash.html"><a href="logstash.html#configure-logstash-to-ingest-with-a-pipeline"><i class="fa fa-check"></i><b>6.5</b> Configure Logstash to ingest with a pipeline</a></li>
<li class="chapter" data-level="6.6" data-path="logstash.html"><a href="logstash.html#check-the-data-from-logstash-in-elasticsearch"><i class="fa fa-check"></i><b>6.6</b> Check the data from Logstash in Elasticsearch</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="visualisation.html"><a href="visualisation.html"><i class="fa fa-check"></i><b>7</b> Visualisation</a><ul>
<li class="chapter" data-level="7.1" data-path="visualisation.html"><a href="visualisation.html#analyze"><i class="fa fa-check"></i><b>7.1</b> Analyze</a></li>
<li class="chapter" data-level="7.2" data-path="visualisation.html"><a href="visualisation.html#visualisation-1"><i class="fa fa-check"></i><b>7.2</b> Visualisation</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Elasticsearch Data Fundamentals</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="winlogbeat" class="section level1">
<h1><span class="header-section-number">4</span> Winlogbeat</h1>
<p>In this lab we will display Windows logs in our Kibana dashboard. The end results will look similar to the following screenshot:</p>
<div class="figure">
<img src="img/screenshot_winlogbeat_host_selecteerd_2_visualisaties.PNG" alt="Winlogbeat showing Windows logs in Kibana" />
<p class="caption">Winlogbeat showing Windows logs in Kibana</p>
</div>
<div id="setup-winlogbeat" class="section level2">
<h2><span class="header-section-number">4.1</span> Setup Winlogbeat</h2>
<p>Just like in the labs for Elasticsearch, Kibana and Metricbeat, also Winlogbeat will be started from the Command Line. Make sure Elasticsearch and Kibana are running, both in their seperate Command Line sessions. Open a new Command Line and navigate to the directory where Winlogbeat is located.</p>
<div class="figure">
<img src="img/start_command_prompt_windows.jpg" alt="Start the Command Line (Command Prompt) in Windows" />
<p class="caption">Start the Command Line (Command Prompt) in Windows</p>
</div>
<pre class="bat"><code>cd winlogbeat-7.11.2-windows-x86_64
cd winlogbeat-7.11.2-windows-x86_64</code></pre>
<blockquote>
<p>In my case, the main files of Winlogbeat are located in another folder called <code>winlogbeat-7.11.2-windows-x86_64</code>. Therefore the two similar commands.</p>
</blockquote>
<p>Use the <code>dir</code> command to get an overview of the files and folders in the main directory of Winlogbeat.</p>
<div class="figure">
<img src="img/screenshot_overview_winlogbeat.PNG" alt="Files in the main Winlogbeat directory" />
<p class="caption">Files in the main Winlogbeat directory</p>
</div>
<p>Just like Metricbeat, we need to setup Winlogbeat if this is the first time we use this version on the computer.</p>
<pre class="bat"><code>winlogbeat setup</code></pre>
<p>Just like the setup of Metricbeat, the setup of Windows may take a little while.</p>
<div class="figure">
<img src="img/screenshot_winlogbeat_setup_eerste_keer.PNG" alt="Winlogbeat setup" />
<p class="caption">Winlogbeat setup</p>
</div>
<p>When the setup is finished, we can start Winlogbeat:</p>
<pre class="bat"><code>winlogbeat</code></pre>
<div class="figure">
<img src="img/screenshot_winlogbeat_gestart.PNG" alt="Start Winlogbeat from the Command Line" />
<p class="caption">Start Winlogbeat from the Command Line</p>
</div>
<p>No that we have started Winlogbeat, we want to initiate our dashboard for Windows logs in Kibana.</p>
</div>
<div id="initiate-the-windows-logs-dashboard-in-kibana" class="section level2">
<h2><span class="header-section-number">4.2</span> Initiate the Windows logs dashboard in Kibana</h2>
<p>From the homescreen of Kibana, select the option <strong>Add data</strong></p>
<div class="figure">
<img src="img/screenshot_homepage_kibana.PNG" alt="Add data" />
<p class="caption">Add data</p>
</div>
<p>From the list of pre-configured options select <strong>Windows Event Log</strong></p>
<div class="figure">
<img src="img/screenshot_windows_adddata_winlogbeat.PNG" alt="Windows Event Log from the pre-configured options" />
<p class="caption">Windows Event Log from the pre-configured options</p>
</div>
<p>Since we already executed the options for the (initial) setup of Winlogbeat, we can ignore the steps descbribed.</p>
<p>We can verify if Elasticsearch has already received some data of our running Winlogbeat instance in the Command Line. Select the button <strong>Check data</strong> to let Kibana check if we already have some data.</p>
<p>We get a message if Elasticsearch has succesfully received our data.</p>
<div class="figure">
<img src="img/screenshot_winlogbeat_stap_4_klik_data_received_.PNG" alt="Kibana Winlogbeat check data" />
<p class="caption">Kibana Winlogbeat check data</p>
</div>
<p>Next click the <strong>SIEM app</strong> button to explore our data.</p>
<div class="figure">
<img src="img/screenshot_winlog_beat_done_check_siem_app.PNG" alt="Explore data SIEM" />
<p class="caption">Explore data SIEM</p>
</div>
<p>Congratulations, we are now presented with our Windows logs files in the dashboard. Make sure the filters are properly set. You can also scroll down the page in order to view all the visualisations.</p>
<p><img src="img/winlogbeat_siem_app_empty.PNG" alt="Dashboard Windows logs" />
<img src="img/winlogbeat_screenshot_siem_scroll_naar_beneden_events.PNG" alt="Dashboard Windows logs when scrolling down" /></p>
<p>When we drill down the different visualisations we also get different tables that show our Windows logs. For example, you can click <strong>View Events</strong>.</p>
<div class="figure">
<img src="img/screenshot_winlogbeat_host_selecteerd_2_visualisaties.PNG" alt="Windows logs" />
<p class="caption">Windows logs</p>
</div>
</div>
<div id="check-out-the-windows-logs-in-the-elasticsearch-index" class="section level2">
<h2><span class="header-section-number">4.3</span> Check out the Windows logs in the Elasticsearch index</h2>
<p>Let’s checkout the raw Windows logs in our Elasticsearch index. In the Kibana menu, navigate to Dev Tools.</p>
<p>In the Editor, execute the Elasticsearch request to get an overview of our current indices.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="er">GET</span> <span class="er">_cat/indices?v</span></a></code></pre></div>
<p>The list with indices contains an index staring with <code>winlogbeat</code> (followed by the timestamp of the initation of the Winlogbeat instance).</p>
<p>Let’s checkout what a Window log line indexed in Elasticsearch looks like</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="er">GET</span> <span class="er">winlogbeat-*/_search</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="fu">{</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3">  <span class="dt">&quot;query&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4">    <span class="dt">&quot;match_all&quot;</span><span class="fu">:</span> <span class="fu">{}</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5">  <span class="fu">}</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="fu">}</span></a></code></pre></div>
<div class="figure">
<img src="img/screenshot_voorbeeld_output_winlogbeat_document_bekijken.PNG" alt="A Windows log indexed in Elasticsearch" />
<p class="caption">A Windows log indexed in Elasticsearch</p>
</div>
<p>The <code>_source</code> field contains the original Windows log line.</p>
</div>
<div id="index-patterns-en-discover" class="section level2">
<h2><span class="header-section-number">4.4</span> Index Patterns en Discover</h2>
<p>Just like Metricbeat, we have the possiblity to discover the Windows logs provided by Windlogbeat. This requires us to also define an Index Pattern for our <code>winlogbeat</code> index. In <a href="##specify-index-patterns">see above</a> we can recall these steps.</p>
<div class="figure">
<img src="img/screenshot_winlogbeat_discover.PNG" alt="Discover Windows Logs" />
<p class="caption">Discover Windows Logs</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="metricbeat.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="filebeat.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
